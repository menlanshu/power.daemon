# PowerDaemon RabbitMQ Configuration
# Optimized for development and production environments

# Basic Configuration
loopback_users.guest = false
listeners.tcp.default = 5672

# Management Plugin
management.listener.port = 15672
management.listener.ssl = false
management.load_definitions = /etc/rabbitmq/definitions.json

# Memory Management
vm_memory_high_watermark.relative = 0.7
vm_memory_high_watermark_paging_ratio = 0.5

# Disk Space Management
disk_free_limit.relative = 2.0
disk_free_limit.absolute = 2GB

# Clustering
cluster_partition_handling = autoheal
cluster_keepalive_interval = 10000

# Networking
tcp_listen_options.backlog = 128
tcp_listen_options.nodelay = true
tcp_listen_options.linger.on = true
tcp_listen_options.linger.timeout = 0

# Security
auth_mechanisms.1 = PLAIN
auth_mechanisms.2 = AMQPLAIN

# Queue Defaults
default_vhost = powerdaemon
default_user = powerdaemon
default_pass = PowerDaemon2024!

# Performance Optimizations for Production Scale
# Increase these values for 200+ server deployments
channel_max = 2000
connection_max = 1000
heartbeat = 60

# Message Store
msg_store_file_size_limit = 16777216
msg_store_credit_disc_bound = 4000

# Queue Index
queue_index_embed_msgs_below = 4096
queue_index_max_journal_entries = 65536

# Garbage Collection
collect_statistics = true
collect_statistics_interval = 5000

# Logging
log.console = true
log.console.level = info
log.console.formatter = json

log.file = true
log.file.level = info
log.file.rotation.date = $D0
log.file.rotation.size = 10485760
log.file.rotation.count = 5

# Background GC
background_gc_enabled = true
background_gc_target_interval = 60000

# Plugin Configuration
management.rates_mode = basic

# SSL/TLS Configuration (for production)
# ssl_options.cacertfile = /etc/ssl/certs/ca-cert.pem
# ssl_options.certfile = /etc/ssl/certs/server-cert.pem
# ssl_options.keyfile = /etc/ssl/private/server-key.pem
# ssl_options.verify = verify_peer
# ssl_options.fail_if_no_peer_cert = true

# High Availability
# For production clusters
delegate_count = 16
tcp_listen_options.sndbuf = 196608
tcp_listen_options.recbuf = 196608